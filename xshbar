#!/bin/sh
# xshbar
# customizable xsetroot bar for window managers
# written by speedie, licensed under MIT.
XSHBAR_INIT()
{
  echo "xshbar has started." && XSHBAR_VAR_HASSTARTED=true
  export LOAD=.
  export PLUGDIR=$XSHBAR_VAR_DOTDIR/plugins
}

XSHBAR_SOURCE()
{
  . ~/.config/xshbar/config || . $XSHBAR_VAR_DOTDIR/config # Import config
  . ~/.config/xshbar/plugin || . $XSHBAR_VAR_DOTDIR/plugin # Import plugins
}

XSHBAR_DIE()
{
  XSH_VAR_HASSTARTED=false && exit 1 # Failed exit.
}

XSHBAR_END()
{
  XSH_VAR_HASSTARTED=false && exit 0 # Successful exit
}

XSHBAR_CHECK_DEP()
{
  ls $XSHBAR_BIN_DIR/xsetroot > /dev/null || echo "xsetroot not found" && XSHBAR_DIE
}

# Check to make sure every dependency is installed.
XSHBAR_INIT || XSHBAR_DIE
XSHBAR_SOURCE || XSHBAR_DIE
XSHBAR_CHECK_DEP || XSHBAR_DIE

xsetroot -name "$(echo $XSHBAR_CORE_DISPLAY)" || XSHBAR_DIE

XSHBAR_END
